<app-navbar></app-navbar>

<div class="page-container">
  <div class="page-header">
    <h2> Mon Profil</h2>
    <p>Gérez vos informations personnelles</p>
  </div>

  <div class="profile-container" *ngIf="user; else notConnected">
    <div class="profile-card">
      <div class="profile-avatar">
        <img [src]="user.avatar ? 'assets/avatars/' + user.avatar : 'assets/default-avatar.jpg'" alt="Avatar" />        <button class="avatar-edit-btn" title="Modifier l'avatar" (click)="openAvatarSelector()">✏️</button>

        <div class="avatar-selector-modal" *ngIf="showAvatarSelector">
          <div class="avatar-selector">
            <div *ngFor="let avatar of availableAvatars" class="avatar-option">
              <img [src]="'assets/avatars/' + avatar" alt="Avatar"
                   (click)="selectAvatar(avatar)" [class.selected]="avatar === user.avatar" />
            </div>
            <button (click)="showAvatarSelector = false">Annuler</button>
          </div>
        </div>
        </div>

      <div class="profile-info">
        <div class="input-group">
          <input type="text" [(ngModel)]="editableUser.username" placeholder="Nom d'utilisateur" />
          <label>Nom d'utilisateur</label>
        </div>

        <div class="input-group">
          <input type="email" [(ngModel)]="editableUser.email" placeholder="Email" />
          <label>Email</label>
        </div>

        <div class="input-group">
          <select [(ngModel)]="editableUser.cbu">
            <option value="" disabled selected>Choisissez un CBU</option>
            <option>PCPR : Product Conformity Performance Reliability</option>
            <option>ME : Manufacturing Engineering</option>
            <option>EES : Electronic Embedded Systems</option>
            <option>DET : Digital and Technology</option>
            <option>MPE : Mechanical Product Engineering</option>
            <option>CSP </option>
            <option>SGA</option>

          </select>
          <label>CBU</label>
        </div>
        
        

        

        
      </div>
    </div>

    <div class="profile-actions">
      <button class="btn btn-primary" (click)="onSave()" [disabled]="!hasChanges()">Sauvegarder</button>
      <button class="btn btn-secondary" (click)="onCancel()"> Annuler</button>
    </div>
  </div>

  <ng-template #notConnected>
    <p>Vous n'êtes pas connecté(e).</p>
  </ng-template>
</div>
